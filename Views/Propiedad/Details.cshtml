@model StayGo.Models.Propiedad
@{
    ViewData["Title"] = Model.Titulo;
    var cover = Model.Imagenes?.OrderByDescending(i=>i.EsPrincipal).FirstOrDefault()?.Url
                ?? "/img/placeholder.png";
}
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />

<div class="container py-4">
  <h2 class="mb-2">@Model.Titulo</h2>
  <div class="text-muted mb-2">
    <i class="bi bi-geo-alt"></i> @Model.Direccion?.Ciudad, @Model.Direccion?.Pais
  </div>
  @if (Model.PrecioPorNoche.HasValue){
    <div class="fw-semibold mb-3">S/ @Model.PrecioPorNoche.Value.ToString("0.##") por noche</div>
  }

  <img src="@cover" class="img-fluid rounded mb-3" style="object-fit:cover;max-height:360px;width:100%;" />

  <p>@Model.Descripcion</p>

  <div class="border rounded p-3 bg-light my-3">
    <strong>Mapa (placeholder)</strong>
    <div class="small text-muted">Lat: @Model.Lat, Lng: @Model.Lng</div>
    <div style="height:180px;background:#e9ecef;border-radius:.5rem;"
         class="d-flex align-items-center justify-content-center">
      <span class="text-secondary">[Aquí iría el mapa]</span>
    </div>
  </div>

  <a class="btn btn-primary mb-4" href="/Reservas/Nueva/@Model.Id">Reservar</a>

  <h4>Reseñas (@(Model.Resenas?.Count ?? 0))</h4>
  @if (Model.Resenas == null || !Model.Resenas.Any()){
    <div class="text-muted">Aún no hay reseñas.</div>
  } else {
    @foreach (var r in Model.Resenas.OrderByDescending(x => x.Fecha)){
      <div class="border-bottom py-2">
        <div class="small text-muted">@r.Fecha.ToShortDateString() — ⭐ @r.Puntuacion/5</div>
        <div>@r.Comentario</div>
      </div>
    }
  }
</div>
